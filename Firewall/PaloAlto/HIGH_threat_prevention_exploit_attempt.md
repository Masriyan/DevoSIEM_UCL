# Palo Alto - Threat Prevention Exploit Attempt

## Severity
**HIGH**

## Description
Detects exploit attempts blocked or alerted by Palo Alto threat prevention engine. Indicates active exploitation attempts against network resources.

## MITRE ATT&CK
- **Tactic**: Initial Access (TA0001), Execution (TA0002)
- **Technique**: Exploit Public-Facing Application (T1190), Exploitation for Client Execution (T1203)

## DEVO Query

```sql
from firewall.paloalto.threat
where threat_type in ("vulnerability", "exploit-kit")
  and severity in ("critical", "high")
  and action in ("alert", "block", "drop")
select
  eventdate,
  srcip,
  dstip,
  srcuser,
  dstport,
  application,
  threat_id,
  threat_name,
  category,
  severity,
  action,
  url,
  direction
group by srcip, dstip, threat_name, dstport
```

## Alert Configuration
- **Trigger**: 3 or more attempts within 10 minutes
- **Throttling**: 1 alert per srcip+dstip pair per 15 minutes
- **Severity**: High
- **Priority**: P2

## Recommended Actions
1. Identify vulnerable application/service being targeted
2. Verify if exploit was successful (check endpoint logs)
3. Review source IP reputation
4. Check for successful connections from same source
5. Patch vulnerable system immediately
6. Consider blocking source IP/network
7. Review firewall rule allowing traffic to vulnerable service

## False Positive Considerations
- Legitimate vulnerability scans
- Security assessments
- Compatibility scanners
- Outdated threat signatures

**Tuning Recommendations**:
- Whitelist approved vulnerability scanner IPs
- Adjust threshold based on baseline
- Filter out known false positives by threat_id

## Enrichment Opportunities
- Correlate with vulnerability scan data
- Check if destination has known vulnerabilities (Qualys/Tenable)
- Verify source IP against threat intelligence
- Review application version and patch status

## Response Playbook
1. Assess if system is vulnerable to detected exploit
2. Check endpoint for signs of compromise
3. Apply emergency patches if available
4. Implement virtual patching rules
5. Monitor for continued attempts
6. Review access controls to affected service

## Automation Opportunities
- Auto-create firewall block rule for repeat offenders
- Trigger vulnerability scan of targeted system
- Automated ticket creation for patching team
- Dynamic block list updates

## Notes
- Not all exploit attempts indicate compromise
- Blocked attempts still require investigation
- Vulnerability may exist even if exploit failed
